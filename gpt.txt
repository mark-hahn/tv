i undid that because spec changed...

instead of logging lines to tv.log immediately, buffer them and wait until line 238: # file passed all block tests, process it, is reached. then dump buffer to log and start logging live.

after line 299:      log "***********************************************************", is executed clear the buffer and then start buffering again until line 238 is reached.

when app starts don't buffer until line 299 is executed.


you said "While buffering:
if a file gets skipped/blocked/recent/error before passing block tests, its buffered lines are discarded (so they donâ€™t leak into the next flush)."

this is not correct. do not pay attention to any behavior other thsn the requested buffer actions at line 238 and line 299. at 238 you output the buffer to the log and go live. you stay live until line 299 is reached and you start the buffering over again.

currently is retrieves a list of files from the usb server, processes them and then quits.  change it so it doesn't quit but retrieves and processes the files every five minutes. run it in pm2.  whenever it starts processing keep it in buffer mode and ndo ot start live like it does when the app starts.

create a FAST_TEST constant that when true has it process once every 30 secs instead of 5 mins, for testing

i removed an entry form tv-recent and it was not processed.  refresh memory contente of tv-recent.json, and any other in-memory copies of files.
--
only run prune.sh once an hour 

would you recommend switching to use main.js and not use coffeescript any more?

==========================================

tv.log is read and tailed and trimmed by another app.  so no maintenance of tv.log is needed.
--
change name of pm2 process to tv-proc 
-- 
switch from using guessit to using npm module parse-torrent-title. 
-- 
delay starting processing until 5 mins (or 30 secs) have elapsed since finishing last processing
--
sort files by title before processing
--
add server functionality to app to provide an endpoint for a request to a function startProc(title) which takes a title arg and returns {"status":"ok"} for success or {"status":<error msg>} for error.
-- 
startProc() should stop processing while waiting for any single file processing to finish, and then it should trigger a new processing cycle where title is processed first before other files.
--
if there is no title arg or there is no matching file then just restart the cycle
--
use port 3003
--
 the request will come from a browser so handle cors properly 
--
write sample code to a file client.js to run in the browser to call the function with fetch.

==========================================

